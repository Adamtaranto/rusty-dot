
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Fast dot plot comparisons of DNA sequences using an FM-Index">
      
      
      
        <link rel="canonical" href="https://adamtaranto.github.io/rusty-dot/api/sequence_index/">
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../dotplot/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.2">
    
    
      
        <title>SequenceIndex - rusty-dot</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sequenceindex" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="rusty-dot" class="md-header__button md-logo" aria-label="rusty-dot" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            rusty-dot
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              SequenceIndex
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="teal"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="teal"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Adamtaranto/rusty-dot" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Adamtaranto/rusty-dot
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../installation/" class="md-tabs__link">
        
  
  
    
  
  Installation

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../development/" class="md-tabs__link">
        
  
  
    
  
  Development Guide

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../tutorials/quickstart/" class="md-tabs__link">
          
  
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="rusty-dot" class="md-nav__button md-logo" aria-label="rusty-dot" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    rusty-dot
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Adamtaranto/rusty-dot" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Adamtaranto/rusty-dot
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Development Guide
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tutorials
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tutorials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start Tutorial
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/dotplot_tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dotplot Visualization Tutorial
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/paf_workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PAF Workflow Tutorial
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/all_vs_all_two_indices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    All-vs-All Dotplot Between Two Sequence Indices
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/minimap2_paf_tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Visualising Minimap2 Alignments with rusty-dot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    SequenceIndex
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    SequenceIndex
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-multiple-sequences-are-stored" class="md-nav__link">
    <span class="md-ellipsis">
      
        How multiple sequences are stored
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#class" class="md-nav__link">
    <span class="md-ellipsis">
      
        Class
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex" class="md-nav__link">
    <span class="md-ellipsis">
      
        SequenceIndex
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SequenceIndex">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attributes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.k" class="md-nav__link">
    <span class="md-ellipsis">
      
        k
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.add_sequence" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_sequence
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.load_fasta" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_fasta
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.sequence_names" class="md-nav__link">
    <span class="md-ellipsis">
      
        sequence_names
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.get_kmer_set" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_kmer_set
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.get_sequence_length" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_sequence_length
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.compare_sequences" class="md-nav__link">
    <span class="md-ellipsis">
      
        compare_sequences
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.get_paf" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_paf
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.get_paf_all" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_paf_all
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.precompute_all_pairs" class="md-nav__link">
    <span class="md-ellipsis">
      
        precompute_all_pairs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.compare_sequences_stranded" class="md-nav__link">
    <span class="md-ellipsis">
      
        compare_sequences_stranded
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.optimal_contig_order" class="md-nav__link">
    <span class="md-ellipsis">
      
        optimal_contig_order
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        save
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        load
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __len__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __repr__
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dotplot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DotPlotter
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paf_io/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PAF I/O
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Low-Level Functions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-multiple-sequences-are-stored" class="md-nav__link">
    <span class="md-ellipsis">
      
        How multiple sequences are stored
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#class" class="md-nav__link">
    <span class="md-ellipsis">
      
        Class
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex" class="md-nav__link">
    <span class="md-ellipsis">
      
        SequenceIndex
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SequenceIndex">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attributes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.k" class="md-nav__link">
    <span class="md-ellipsis">
      
        k
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.add_sequence" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_sequence
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.load_fasta" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_fasta
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.sequence_names" class="md-nav__link">
    <span class="md-ellipsis">
      
        sequence_names
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.get_kmer_set" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_kmer_set
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.get_sequence_length" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_sequence_length
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.compare_sequences" class="md-nav__link">
    <span class="md-ellipsis">
      
        compare_sequences
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.get_paf" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_paf
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.get_paf_all" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_paf_all
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.precompute_all_pairs" class="md-nav__link">
    <span class="md-ellipsis">
      
        precompute_all_pairs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.compare_sequences_stranded" class="md-nav__link">
    <span class="md-ellipsis">
      
        compare_sequences_stranded
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.optimal_contig_order" class="md-nav__link">
    <span class="md-ellipsis">
      
        optimal_contig_order
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        save
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        load
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __len__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusty_dot._rusty_dot.SequenceIndex.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __repr__
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="sequenceindex">SequenceIndex<a class="headerlink" href="#sequenceindex" title="Permanent link">&para;</a></h1>
<p>The <code>SequenceIndex</code> class is the primary interface for building and querying FM-index-backed sequence comparison data.
It is implemented in Rust (via <a href="https://pyo3.rs">PyO3</a>) for maximum performance.</p>
<h2 id="how-multiple-sequences-are-stored">How multiple sequences are stored<a class="headerlink" href="#how-multiple-sequences-are-stored" title="Permanent link">&para;</a></h2>
<p>Each sequence added to a <code>SequenceIndex</code> receives its <strong>own independent FM-index</strong>, built by <a href="https://docs.rs/bio">rust-bio</a>.
The rust-bio FM-index is a read-only data structure that is constructed once for a given sequence and cannot be extended or updated after construction.</p>
<p>This means:</p>
<ul>
<li><strong>Adding sequences accumulates independent indexes.</strong> Calling <code>add_sequence</code> or <code>load_fasta</code> multiple times grows the collection — each call creates a new, isolated FM-index for that sequence only and does not affect any existing FM-index.</li>
<li><strong><code>load_fasta</code> can be called multiple times.</strong> Each call parses a file and adds its sequences to the collection, preserving all sequences that were added previously. Two calls on two separate FASTA files will leave the index containing all sequences from both files.</li>
<li><strong>Re-using a name emits a warning and overwrites.</strong> If <code>add_sequence</code> or a FASTA record uses a name that already exists in the index, a <code>UserWarning</code> is emitted and the existing entry (and its FM-index) is replaced with a new one for the new sequence.</li>
<li><strong>Duplicate names within a FASTA file raise an error.</strong> If a FASTA file contains two records with the same sequence name, <code>load_fasta</code> raises a <code>ValueError</code> before adding any sequences from that file to the index.</li>
<li><strong>Pairwise comparisons use two independent FM-indexes.</strong> <code>compare_sequences</code> and <code>compare_sequences_stranded</code> look up the two named sequences from the dictionary and compare their individual FM-indexes — no combined or merged FM-index is ever created.</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusty_dot</span><span class="w"> </span><span class="kn">import</span> <span class="n">SequenceIndex</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">idx</span> <span class="o">=</span> <span class="n">SequenceIndex</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="c1"># Each call adds a new independent FM-index entry</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">idx</span><span class="o">.</span><span class="n">add_sequence</span><span class="p">(</span><span class="s2">&quot;contig1&quot;</span><span class="p">,</span> <span class="s2">&quot;ACGT&quot;</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="n">idx</span><span class="o">.</span><span class="n">add_sequence</span><span class="p">(</span><span class="s2">&quot;contig2&quot;</span><span class="p">,</span> <span class="s2">&quot;TTTT&quot;</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="nb">print</span><span class="p">(</span><span class="n">idx</span><span class="o">.</span><span class="n">sequence_names</span><span class="p">())</span>   <span class="c1"># [&#39;contig1&#39;, &#39;contig2&#39;]</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="c1"># load_fasta accumulates — sequences from both files are kept</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="n">idx</span><span class="o">.</span><span class="n">load_fasta</span><span class="p">(</span><span class="s2">&quot;assembly_a.fasta&quot;</span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="n">idx</span><span class="o">.</span><span class="n">load_fasta</span><span class="p">(</span><span class="s2">&quot;assembly_b.fasta&quot;</span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">idx</span><span class="o">.</span><span class="n">sequence_names</span><span class="p">()))</span>  <span class="c1"># total from both files plus the two above</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="c1"># Re-using a name emits a UserWarning then replaces the entry</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">(</span><span class="n">record</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">w</span><span class="p">:</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>    <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;always&quot;</span><span class="p">)</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    <span class="n">idx</span><span class="o">.</span><span class="n">add_sequence</span><span class="p">(</span><span class="s2">&quot;contig1&quot;</span><span class="p">,</span> <span class="s2">&quot;GGGG&quot;</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>   <span class="c1"># overwrites old contig1</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>                               <span class="c1"># exactly one warning emitted</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="k">assert</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">category</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>    <span class="c1"># warned before overwriting</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="nb">print</span><span class="p">(</span><span class="n">idx</span><span class="o">.</span><span class="n">get_sequence_length</span><span class="p">(</span><span class="s2">&quot;contig1&quot;</span><span class="p">))</span>        <span class="c1"># 400 (the new sequence)</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="c1"># load_fasta raises ValueError if the FASTA file itself has duplicate names</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>    <span class="n">idx</span><span class="o">.</span><span class="n">load_fasta</span><span class="p">(</span><span class="s2">&quot;file_with_dup_names.fasta&quot;</span><span class="p">)</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>   <span class="c1"># &quot;duplicate sequence name &#39;seq1&#39; in FASTA file &#39;...&#39;&quot;</span>
</code></pre></div>
<h2 id="class">Class<a class="headerlink" href="#class" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h2 id="rusty_dot._rusty_dot.SequenceIndex" class="doc doc-heading">
            <code>SequenceIndex</code>


<a href="#rusty_dot._rusty_dot.SequenceIndex" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">



        <p>FM-index backed sequence comparison engine.</p>
<p>Each sequence added to the index receives its <strong>own independent FM-index</strong>
built by rust-bio.  The FM-index is constructed once per sequence and
cannot be extended after construction, so adding more sequences never
modifies an existing FM-index — it only creates a new one for the
newly added sequence.</p>
<p>The index behaves as a <strong>dictionary of per-sequence FM-indexes</strong>:</p>
<ul>
<li>:meth:<code>add_sequence</code> and :meth:<code>load_fasta</code> <strong>add</strong> new entries to
  the collection; calling either method multiple times accumulates
  sequences rather than replacing the collection.</li>
<li>If a sequence name already exists in the index, a <code>UserWarning</code> is
  emitted and the existing entry is <strong>overwritten</strong> with a new FM-index
  for the new sequence.</li>
<li>:meth:<code>load_fasta</code> raises <code>ValueError</code> if the FASTA file itself
  contains duplicate sequence names.</li>
<li>Pairwise comparisons (:meth:<code>compare_sequences</code>,
  :meth:<code>compare_sequences_stranded</code>) always operate on exactly two
  independent FM-indexes.</li>
</ul>
<p>The k-mer length <code>k</code> is fixed at construction time and applies to all
sequences held in the index.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>k</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The k-mer length to use for indexing and comparison.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Build an index from individual sequences:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span> <span class="o">=</span> <span class="n">SequenceIndex</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span><span class="o">.</span><span class="n">add_sequence</span><span class="p">(</span><span class="s2">&quot;seq1&quot;</span><span class="p">,</span> <span class="s2">&quot;ACGTACGTACGT&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span><span class="o">.</span><span class="n">add_sequence</span><span class="p">(</span><span class="s2">&quot;seq2&quot;</span><span class="p">,</span> <span class="s2">&quot;TACGTACGTACG&quot;</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span><span class="o">.</span><span class="n">sequence_names</span><span class="p">()</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">[&#39;seq1&#39;, &#39;seq2&#39;]</span>
</code></pre></div>
    <p>Accumulate sequences from multiple FASTA files:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span> <span class="o">=</span> <span class="n">SequenceIndex</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span><span class="o">.</span><span class="n">load_fasta</span><span class="p">(</span><span class="s2">&quot;assembly_a.fasta&quot;</span><span class="p">)</span>   <span class="c1"># adds seqs from file A</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span><span class="o">.</span><span class="n">load_fasta</span><span class="p">(</span><span class="s2">&quot;assembly_b.fasta&quot;</span><span class="p">)</span>   <span class="c1"># adds seqs from file B, keeps file A seqs</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">matches</span> <span class="o">=</span> <span class="n">idx</span><span class="o">.</span><span class="n">compare_sequences</span><span class="p">(</span><span class="s2">&quot;seq1&quot;</span><span class="p">,</span> <span class="s2">&quot;seq2&quot;</span><span class="p">)</span>
</code></pre></div>
    <p>Overwrite a sequence by re-using its name:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span> <span class="o">=</span> <span class="n">SequenceIndex</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span><span class="o">.</span><span class="n">add_sequence</span><span class="p">(</span><span class="s2">&quot;seq1&quot;</span><span class="p">,</span> <span class="s2">&quot;ACGTACGT&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span><span class="o">.</span><span class="n">add_sequence</span><span class="p">(</span><span class="s2">&quot;seq1&quot;</span><span class="p">,</span> <span class="s2">&quot;GGGGGGGG&quot;</span><span class="p">)</span>  <span class="c1"># silently replaces the previous seq1</span>
</code></pre></div>











<div class="doc doc-children">





<h3 id="rusty_dot._rusty_dot.SequenceIndex-attributes">Attributes<a href="#rusty_dot._rusty_dot.SequenceIndex-attributes" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-attribute">



<h4 id="rusty_dot._rusty_dot.SequenceIndex.k" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">k</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#rusty_dot._rusty_dot.SequenceIndex.k" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>The k-mer length used for this index.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The k-mer length supplied at construction time.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>


<h3 id="rusty_dot._rusty_dot.SequenceIndex-functions">Functions<a href="#rusty_dot._rusty_dot.SequenceIndex-functions" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-function">


<h4 id="rusty_dot._rusty_dot.SequenceIndex.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">k</span><span class="p">)</span></code>

<a href="#rusty_dot._rusty_dot.SequenceIndex.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Initialise an empty SequenceIndex.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>k</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The k-mer length to use for indexing and comparison.
Must be greater than zero.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>k</code> is zero.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rusty_dot._rusty_dot.SequenceIndex.add_sequence" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_sequence</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">seq</span><span class="p">)</span></code>

<a href="#rusty_dot._rusty_dot.SequenceIndex.add_sequence" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Add a single sequence to the index.</p>
<p>Builds a <strong>new independent FM-index</strong> for <code>seq</code> using rust-bio and
stores it alongside the k-mer set and raw sequence bytes.  Each call
creates a separate FM-index for that sequence only — the rust-bio
FM-index cannot be extended after construction, so adding sequences
never modifies existing FM-indexes.</p>
<p>Calling <code>add_sequence</code> does <strong>not</strong> affect any other sequence already
in the index.  Sequences accumulate: calling this method <em>N</em> times with
<em>N</em> distinct names results in an index holding <em>N</em> independent
FM-indexes.</p>
<p>If a sequence named <code>name</code> already exists in the index, a
<code>UserWarning</code> is emitted and the existing entry is <strong>overwritten</strong>
with a new FM-index for the new <code>seq</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unique identifier for the sequence.  Re-using an existing name
emits a :class:<code>UserWarning</code> and replaces that sequence (and its
FM-index).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seq</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DNA sequence string. Uppercase is recommended; lowercase
input is accepted and treated as uppercase.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the FM-index cannot be built (e.g., invalid characters).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Warns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="UserWarning">UserWarning</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>name</code> already exists in the index (the existing entry is
overwritten).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rusty_dot._rusty_dot.SequenceIndex.load_fasta" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_fasta</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

<a href="#rusty_dot._rusty_dot.SequenceIndex.load_fasta" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Load all sequences from a FASTA or gzipped FASTA file.</p>
<p>Parses the file with needletail (automatic gzip detection) and
builds a fresh <strong>independent FM-index</strong> for each record.</p>
<p>Sequences already in the index are <strong>preserved</strong> — <code>load_fasta</code>
only adds new entries (or overwrites entries whose name already exists
in the index).  Calling <code>load_fasta</code> on two separate files
accumulates all sequences from both files in the same index.</p>
<p>If the FASTA file contains <strong>duplicate sequence names</strong> (two records
with the same identifier), a <code>ValueError</code> is raised before any
sequences are added to the index.</p>
<p>If a record's name <strong>already exists in the index</strong>, a <code>UserWarning</code>
is emitted and the existing entry is overwritten with the new sequence.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to a FASTA (<code>.fa</code>, <code>.fasta</code>) or gzipped FASTA
(<code>.fa.gz</code>, <code>.fasta.gz</code>) file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sequence names (record identifiers) that were added, in the
order they appear in the file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the file cannot be opened or parsed, or if the file contains
duplicate sequence names.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Warns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="UserWarning">UserWarning</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>For each record whose name already exists in the index (those
entries are overwritten).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rusty_dot._rusty_dot.SequenceIndex.sequence_names" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sequence_names</span><span class="p">()</span></code>

<a href="#rusty_dot._rusty_dot.SequenceIndex.sequence_names" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Return all sequence names currently held in the index.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unordered list of sequence identifiers.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rusty_dot._rusty_dot.SequenceIndex.get_kmer_set" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_kmer_set</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

<a href="#rusty_dot._rusty_dot.SequenceIndex.get_kmer_set" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Return the set of unique k-mers for a named sequence.</p>
<p>Only k-mers composed entirely of the characters A, C, G, T are
included (k-mers containing N or other IUPAC codes are excluded).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The sequence identifier.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="set">set</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The set of unique k-mer strings (length <code>k</code>) found in the
sequence.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="KeyError">KeyError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>name</code> is not present in the index.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rusty_dot._rusty_dot.SequenceIndex.get_sequence_length" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_sequence_length</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

<a href="#rusty_dot._rusty_dot.SequenceIndex.get_sequence_length" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Return the length of a named sequence in base pairs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The sequence identifier.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The sequence length in base pairs (not including any
internal sentinel character).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="KeyError">KeyError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>name</code> is not present in the index.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rusty_dot._rusty_dot.SequenceIndex.compare_sequences" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compare_sequences</span><span class="p">(</span><span class="n">query_name</span><span class="p">,</span> <span class="n">target_name</span><span class="p">,</span> <span class="n">merge</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#rusty_dot._rusty_dot.SequenceIndex.compare_sequences" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Find shared k-mer matches between two sequences.</p>
<p>Intersects the k-mer sets of the two sequences and looks up the
coordinates of each shared k-mer in both FM-indexes.  Uses the
smaller k-mer set as the probe for efficiency.</p>
<p>When <code>merge=True</code> (default) consecutive k-mer hits on the same
co-linear diagonal are merged into a single coordinate block.
Results for each <code>(query_name, target_name, merge)</code> combination
are cached; repeated calls with the same arguments are free.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>query_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the query sequence (defines the y-axis in a dotplot).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the target sequence (defines the x-axis in a dotplot).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>merge</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>When <code>True</code> (default), merge consecutive co-linear k-mer
hits into contiguous coordinate blocks.  When <code>False</code>,
every individual k-mer hit is returned as its own block.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>, <span title="int">int</span>, <span title="int">int</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of <code>(query_start, query_end, target_start, target_end)</code>
coordinate tuples.  All coordinates are 0-based; end
positions are exclusive.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="KeyError">KeyError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If either <code>query_name</code> or <code>target_name</code> is not present in
the index.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rusty_dot._rusty_dot.SequenceIndex.get_paf" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_paf</span><span class="p">(</span><span class="n">query_name</span><span class="p">,</span> <span class="n">target_name</span><span class="p">,</span> <span class="n">merge</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#rusty_dot._rusty_dot.SequenceIndex.get_paf" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Return PAF-formatted alignment strings for a sequence pair.</p>
<p>Calls <code>compare_sequences</code> internally (using the cache if
available) and formats the result as 12-column PAF lines.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>query_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the query sequence.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the target sequence.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>merge</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to merge consecutive co-linear k-mer runs before
generating PAF lines.  Default is <code>True</code>.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PAF lines as tab-separated strings.  Each line has 12 fields:
query name, query length, query start, query end, strand,
target name, target length, target start, target end,
residue matches, alignment block length, mapping quality.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="KeyError">KeyError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If either sequence name is not present in the index.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rusty_dot._rusty_dot.SequenceIndex.get_paf_all" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_paf_all</span><span class="p">(</span><span class="n">merge</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#rusty_dot._rusty_dot.SequenceIndex.get_paf_all" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Return PAF-formatted strings for every ordered sequence pair.</p>
<p>Calls :meth:<code>get_paf</code> for every <code>(i, j)</code> pair where <code>i != j</code>,
populating the comparison cache as a side-effect.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>merge</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to merge consecutive co-linear k-mer runs before
generating PAF lines.  Default is <code>True</code>.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>All PAF lines for every pairwise comparison, one line per match.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rusty_dot._rusty_dot.SequenceIndex.precompute_all_pairs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">precompute_all_pairs</span><span class="p">(</span><span class="n">merge</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#rusty_dot._rusty_dot.SequenceIndex.precompute_all_pairs" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Pre-calculate comparisons for every ordered sequence pair.</p>
<p>Iterates over all <code>(i, j)</code> pairs where <code>i != j</code> and calls
<code>compare_sequences</code> for each, populating the cache.  Subsequent
individual calls to <code>compare_sequences</code> for any pair will then
be served from the cache.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>merge</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to merge consecutive co-linear k-mer runs.  Default
is <code>True</code>.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="tuple">tuple</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ordered list of <code>(query_name, target_name)</code> pairs that were
computed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rusty_dot._rusty_dot.SequenceIndex.compare_sequences_stranded" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compare_sequences_stranded</span><span class="p">(</span><span class="n">query_name</span><span class="p">,</span> <span class="n">target_name</span><span class="p">,</span> <span class="n">merge</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#rusty_dot._rusty_dot.SequenceIndex.compare_sequences_stranded" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Find shared k-mer matches between two sequences on both strands.</p>
<p>In addition to the forward (<code>+</code>) strand matches returned by
:meth:<code>compare_sequences</code>, this method also searches for k-mers in
the query whose reverse complement appears in the target, reporting
those as <code>"-"</code> strand matches.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>query_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the query sequence.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the target sequence.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>merge</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to merge co-linear k-mer runs.  Forward runs are merged
by diagonal; reverse runs are merged by anti-diagonal.
Default is <code>True</code>.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>, <span title="int">int</span>, <span title="int">int</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of <code>(query_start, query_end, target_start, target_end, strand)</code>
tuples.  Coordinates are 0-based; end positions are exclusive.
<code>strand</code> is <code>"+"</code> for forward matches and <code>"-"</code> for
reverse-complement matches.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="KeyError">KeyError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If either sequence name is not present in the index.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rusty_dot._rusty_dot.SequenceIndex.optimal_contig_order" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">optimal_contig_order</span><span class="p">(</span><span class="n">query_names</span><span class="p">,</span> <span class="n">target_names</span><span class="p">)</span></code>

<a href="#rusty_dot._rusty_dot.SequenceIndex.optimal_contig_order" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Return query and target contig names sorted for maximum collinearity.</p>
<p>Uses the gravity-centre algorithm: for each query contig the gravity
is the weighted mean of target mid-point positions (normalised by
total target span) across all matches.  Query contigs with no matches
are placed at the end.  The same algorithm is applied symmetrically to
reorder the target contigs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>query_names</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of the query sequences to reorder.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target_names</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of the target sequences to use as the reference axis.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="list">list</span>[<span title="str">str</span>], <span title="list">list</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>(sorted_query_names, sorted_target_names)</code> ordered by ascending
gravity centre.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="KeyError">KeyError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any sequence name is not present in the index.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rusty_dot._rusty_dot.SequenceIndex.save" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

<a href="#rusty_dot._rusty_dot.SequenceIndex.save" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Serialise the index to a binary file.</p>
<p>Stores the original sequence bytes and k-mer sets using bincode.
The FM-index is rebuilt from the sequence bytes when the file is
loaded, so the on-disk format is compact and version-independent.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Destination file path.  The file is created or overwritten.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the file cannot be created or serialisation fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rusty_dot._rusty_dot.SequenceIndex.load" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

<a href="#rusty_dot._rusty_dot.SequenceIndex.load" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Load sequences from a previously serialised index file.</p>
<p>Deserialises sequence bytes and k-mer sets from a file written by
<code>save</code>, then rebuilds the FM-index for each sequence in memory.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to a binary index file produced by <code>save</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the file cannot be read, deserialisation fails, or the
k-mer length stored in the file does not match <code>self.k</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rusty_dot._rusty_dot.SequenceIndex.__len__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

<a href="#rusty_dot._rusty_dot.SequenceIndex.__len__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Return the number of sequences currently held in the index.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Count of indexed sequences.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rusty_dot._rusty_dot.SequenceIndex.__repr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

<a href="#rusty_dot._rusty_dot.SequenceIndex.__repr__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Return a concise string representation of the index.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string of the form <code>SequenceIndex(k=&lt;k&gt;, sequences=&lt;n&gt;)</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.code.copy"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>